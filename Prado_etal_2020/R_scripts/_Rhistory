q("no")
library("phyloseq", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.2")
library("ggplot2", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.2")
theme_set(theme_bw())
rich_sparse_biom = system.file("~/Téléchargements/test/gyrB.an.unique_list.0.02.biom", package="phyloseq")
import_biom(rich_sparse_biom, parseFunction=parse_taxonomy_greengenes)
import_mothur(mothur_shared_file = "~/Téléchargements/test/gyrB.an.unique_list.shared",
mothur_constaxonomy_file = "~/Téléchargements/test/gyrB.an.unique_list.0.02.cons.taxonomy",
parseFunction = parse_taxonomy_default)
mothur = import_mothur(mothur_shared_file = "~/Téléchargements/test/gyrB.an.unique_list.shared",
mothur_constaxonomy_file = "~/Téléchargements/test/gyrB.an.unique_list.0.02.cons.taxonomy",
parseFunction = parse_taxonomy_default)
plot_richness(mothur)
plot_richness(mothur, measures=c("Observed"))
plot_richness(mothur, measures=c("Shannon"))
plot_richness(mothur, measures=c("InvSimpson"))
plot_bar(mothur, fill="Genus")
plot_bar(mothur, fill="Family")
plot_bar(mothur)
rank_names(mothur)
plot_bar(mothur, "Rank6")
plot_bar(mothur, fill="Rank5")
plot_bar(help)
plot_bar(mothur, fill="Rank3")
wh0 = genefilter_sample(mothur, filterfun_sample(function(x) x > 5), A=0.5*nsamples(mothur))
mothur1 = prune_taxa(wh0, mothur)
mothur1 = transform_sample_counts(mothur1, function(x) 1E6 * x/sum(x))
phylum.sum = tapply(taxa_sums(mothur1), tax_table(mothur1)[, "Rank5"], sum, na.rm=TRUE)
top10phyla = names(sort(phylum.sum, TRUE))[1:10]
mothur1 = prune_taxa((tax_table(mothur1)[, "Rank5"] %in% top10phyla), mothur1)
mothur.ord <- ordinate(mothur1, "NMDS", "bray")
p1 = plot_ordination(mothur1, mothur.ord, type="taxa", color="Phylum", title="taxa")
print(p1)
p1 = plot_ordination(mothur1, mothur.ord, type="taxa", color="Rank5", title="taxa")
print(p1)
